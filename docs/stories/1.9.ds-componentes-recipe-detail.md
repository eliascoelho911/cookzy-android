# Story 1.9: Design System — Componentes para RecipeDetail (Épico 01)

## Status
Ready

## Story
Como equipe de desenvolvimento do Cookzy,
eu quero componentes reutilizáveis no Design System para a tela de Detalhe da Receita,
para padronizar o redesign da Story 1.6 com acessibilidade, consistência visual e maior velocidade de implementação.

## Acceptance Criteria
1. Componentes DS implementados no módulo `ds`, prontos para a Story 1.6, com APIs estáveis, estateless e sem dependência de ViewModel:
   - RecipeHero: capa opcional (imagem), título e tempo de preparo (opcional) com `IconRegistry.Timer`; `contentDescription` adequado; estados com/sem imagem; sem CTA de vídeo.
   - TitleBlock: título + subtítulo. `title` e `subtitle` devem ser `@Composable () -> Unit`, com `CompositionLocalProvider` aplicando `TitleBlockStyle` → `TextStyle` padrão (`Large` vs `Small`). Não deve renderizar ícones dedicados de tempo (timer é responsabilidade do RecipeHero/AppBar).
   - Tabs (genérico): TabRow configurável para qualquer contexto. Para Detalhe, rótulos padrão "Ingredientes/Instruções/Nutrição". Props: `items` (lista de rótulos/ícones/badges), `selectedIndex`, `onSelect(index)`, `scrollable` (fixa/rolável), `style` (primária/secundária/segmented). Acessível (role de Tab, foco, indicador visível). Rótulos configuráveis (ex.: "Preparo").
   - IngredientRow: linha de ingrediente baseada em `rawText` com destaque visual para quantidades derivadas (números/frações). A API aceita o texto original e um `AnnotatedString` (quando fornecido) para destaque; não persiste unidade.
   - InstructionRow: linha de instrução numerada (1., 2., 3., …) com texto puro/`AnnotatedString`; não renderiza chips de tempo/temperatura; foco/ordem previsível.
   - NutritionPlaceholder: placeholder semântico e responsivo para quando não houver dados nutricionais.
2. Acessibilidade: alvos ≥ 48dp onde aplicável; `contentDescription` para imagens; semântica de Tab adequada; leitura clara das quantidades.
3. Previews: light/dark e uma variação com `fontScale≈2.0` para cada componente (incluir estados com/sem imagem; quantidade destacada; nutrição ausente).
4. Testes Compose: smoke tests de renderização/estados e interação essencial (troca de abas; foco/indicador; presença de destaque na `IngredientRow`; `InstructionRow` numerada).
5. Iconografia: todos os ícones consumidos exclusivamente via `IconRegistry`.

### UI Parity vs Mock (com restrições do épico)
- Componentes devem corresponder ao layout visual do mock para: capa sem overlay, título/tempo, abas, linhas de ingrediente com destaque e placeholder de nutrição.
- Não incluir nos componentes deste épico: botão “Iniciar Preparo”, Stepper de Porções, botão “Medidas”, cards de macros/kcal, overlay/CTA de vídeo, chips de tempo/temperatura, Prep Bar, ações de carrinho/favoritos/curtir e tooltips contextuais.

## Tasks / Subtasks
- [ ] DS — RecipeHero (imagem opcional, título, tempo; a11y; previews; testes)
- [ ] DS — TitleBlock (Styles Large e Small; subtítulo/metadado; ação opcional; composição de `title`/`subtitle` via slots com `CompositionLocalProvider`; sem timer embutido; a11y; previews; testes)
- [ ] DS — Tabs (genérico: itens configuráveis; fixa/rolável; a11y; previews; testes)
- [ ] DS — IngredientRow (API para `rawText` + `AnnotatedString` opcional; destaque; a11y; previews; testes)
- [ ] DS — NutritionPlaceholder (layout simples; a11y; previews; testes)
- [ ] DS — InstructionRow (índice + texto; a11y; previews; testes)
- [ ] DS — Verificação de iconografia (uso exclusivo de `IconRegistry.Timer` e afins)
- [ ] Handoff — snippets de uso para integração na Story 1.6

## Dev Notes
- Referências cruzadas:
  - Story 1.6 (Detalhe): `docs/stories/1.6.redesenhar-detalhe-da-receita.md`
  - Arquitetura/Standards: `docs/architecture.md` e `docs/architecture/coding-standards.md` (IconRegistry, Previews, A11y, strings.xml)
- Assinaturas sugeridas:
  - `@Composable fun RecipeHero(title: String, timeMinutes: Int?, image: Painter?, contentDescription: String?, modifier: Modifier = Modifier)`
  - `data class TabItem(val label: String, val icon: ImageVector? = null, val badge: Int? = null)`
  - `enum class TabStyle { Primary, Secondary, Segmented }`
  - `@Composable fun Tabs(items: List<TabItem>, selectedIndex: Int, onSelect: (Int) -> Unit, scrollable: Boolean = false, style: TabStyle = TabStyle.Primary, modifier: Modifier = Modifier)`
  - `enum class TitleBlockStyle { Large, Small }`
  - `@Composable fun TitleBlock(title: @Composable () -> Unit, subtitle: (@Composable () -> Unit)? = null, style: TitleBlockStyle = TitleBlockStyle.Small, modifier: Modifier = Modifier)`
  - `@Composable fun TitleText(text: String)` / `TitleSubtitle(text: String)` utilitários opcionais para reutilizar estilos via CompositionLocal.
  - `@Composable fun IngredientRow(rawText: String, highlighted: AnnotatedString? = null, modifier: Modifier = Modifier)`
  - `@Composable fun InstructionRow(index: Int, text: AnnotatedString, modifier: Modifier = Modifier)`
  - `@Composable fun NutritionPlaceholder(modifier: Modifier = Modifier)`
- Quantidade/destaque:
  - Heurística simples recomendada para derivar destaque quando o `AnnotatedString` não for fornecido: detectar números (inteiros/frações como 1/2, ¼) e tokens comuns (xícaras, colheres, g, kg, ml, l, unidade) apenas para ênfase visual. Não persistir unidade.
- Strings: definir rótulos/títulos em `app/src/main/res/values/strings.xml`; DS pode aceitar `String`/`AnnotatedString` como entrada e deixar a origem para o app.
- Previews: fornecer variações com/sem imagem, com tempo/sem tempo e `fontScale` elevado para validar acessibilidade.

### Handoff — snippets de uso (Story 1.6)
```kotlin
@Composable
fun RecipeDetailHeader(title: String, timeMinutes: Int?, image: Painter?) {
  RecipeHero(
    title = title,
    timeMinutes = timeMinutes,
    image = image,
    contentDescription = title
  )
  TitleBlock(
    title = { TitleText(title) },
    subtitle = { TitleSubtitle("Uma deliciosa lasanha para comer com a família") },
    style = TitleBlockStyle.Large
  )
}

@Composable
fun RecipeDetailTabs(selected: Int, onSelect: (Int) -> Unit) {
  val items = listOf(
    TabItem("Ingredientes"),
    TabItem("Instruções"),
    TabItem("Nutrição")
  )
  Tabs(items = items, selectedIndex = selected, onSelect = onSelect)
}

@Composable
fun IngredientItem(raw: String, annotated: AnnotatedString?) {
  IngredientRow(rawText = raw, highlighted = annotated)
}

@Composable
fun InstructionItem(index: Int, text: AnnotatedString) {
  InstructionRow(index = index, text = text)
}

@Composable
fun NutritionSection(hasData: Boolean) {
  if (!hasData) NutritionPlaceholder()
}

@Composable
fun SectionHeader(title: String, subtitle: String?, action: @Composable (() -> Unit)?) {
  TitleBlock(
    title = { TitleText(title) },
    subtitle = subtitle?.let { { TitleSubtitle(it) } },
    style = TitleBlockStyle.Small
  )
}
```

## Change Log
| Date       | Version | Description                            | Author |
|------------|---------|----------------------------------------|--------|
| 2025-11-03 | 0.1     | Rascunho inicial (DS RecipeDetail)     | PO     |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
- TitleBlock deve aplicar `CompositionLocalProvider(LocalTextStyle provides style.textStyle)` para `title` e `subtitle` quando os slots não sobrepuserem o estilo manualmente (`Large` para headline principal, `Small` para seções).
