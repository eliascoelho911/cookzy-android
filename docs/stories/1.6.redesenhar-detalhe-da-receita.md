# Story 1.6: Redesenhar Detalhe da Receita (protótipo Compose)

## Status
Ready

## Story
**Como** usuário do Cookzy,
**eu quero** um Detalhe de Receita com hierarquia clara e abas consistentes,
**para** ler ingredientes/preparo/nutrição com melhor legibilidade.

## Acceptance Criteria
1. App Bar com voltar e ações contextuais conforme disponível (ex.: Editar). Compartilhar/CTA de vídeo ficam fora do escopo deste épico.
2. Hero no topo com imagem da receita quando disponível (sem overlay de Play). Título exibido com tempo de preparo (campo opcional) quando houver.
3. Abas: Ingredientes | Instruções | Nutrição (label pode ser "Preparo" no código/PRD; a cópia é flexível via DS Tabs genérico). Ingredientes exibem linhas a partir de `rawText` com a quantidade destacada quando inferível (sem unidade persistida). Nutrição pode exibir placeholder quando não houver dados.
4. Fora do escopo do Épico 01: Stepper de Porções, Resumo Nutritivo, botão “Iniciar preparo”, CTA de vídeo externo (timestamp), chips de tempo/temperatura embutidos e Prep Bar persistente.
5. Estados: carregando/erro conforme padrão do app.

### UI Parity vs Mock (com restrições do épico)
- Incluído neste épico: imagem de capa (sem overlay Play), título, tempo opcional, abas (Ingredientes/Instruções/Nutrição) e listas básicas (ingredientes com destaque de quantidade; instruções como lista numerada simples), placeholders de erro/carregamento.
- Explicitamente fora do escopo (não deve aparecer):
  - Botão “Iniciar Preparo”.
  - Stepper de Porções e botão “Medidas”.
  - Resumo Nutritivo (cards de macros/kcal) no cabeçalho.
  - CTA/overlay de vídeo (Play) e ícone/CTA de origem de vídeo.
  - Chips embutidos de tempo/temperatura em instruções.
  - Prep Bar persistente (mini‑timer).
  - Ações de carrinho/compra e botões de favoritos/curtidas.
  - Tooltips contextuais em menções de ingredientes no texto das instruções.

## Dependencies
- PRD — Detalhe com abas e escopo: `docs/prd.md:111`, CTA de vídeo (fora do escopo aqui): `docs/prd.md:72,115`.
- Arquitetura (Compose): padrões de abas, A11y, Previews e Iconografia: `docs/architecture.md:60,80-86`;
  Coding Standards (IconRegistry, Previews, strings.xml): `docs/architecture/coding-standards.md:72-83,100-101`;
  Tech Stack (Material Icons Extended): `docs/architecture/tech-stack.md:12,48-49`.
- Protótipos Compose (Detalhe): `prototype/.../epic01/recipe/detail` (referência visual de estados).
- DS — Componentes para RecipeDetail (pré‑requisito): `docs/stories/1.9.ds-componentes-recipe-detail.md`

## Tasks / Subtasks
- [ ] UI — Reorganizar o topo (Hero/Título/Tempo) sem CTA de vídeo, com AppBar estilo Transparent sobre o Hero (AC: 2)
- [ ] Tabs — Integrar DS Tabs (genérico) com rótulos "Ingredientes/Instruções/Nutrição" (AC: 3)
- [ ] TitleBlock — Usar componente DS para título principal (style Large) e cabeçalhos de seção (style Small) com ação opcional (AC: 2-3)
- [ ] Conteúdo — Ingredientes com destaque de quantidade derivada via `IngredientRow`; Instruções usando `InstructionRow` (lista numerada simples); Nutrição placeholder (AC: 3)
- [ ] Escopo — Ocultar/adiar itens fora do escopo (Stepper/Resumo/Preparo/CTA/Chips/Prep Bar) (AC: 4)
- [ ] A11y — Abas com foco/indicador; hero com `contentDescription`; leitura de quantidades; controles ≥ 48dp (AC: 2–4)
- [ ] Testes — Compose UI (abas; destaque de quantidade; estados) (AC: 3, 5)

## Dev Notes
- Referência de design: docs/prototypes/README.md (seção Detalhe) e protótipos Compose em `prototype/.../epic01/recipe/detail`.
- Arquitetura/UI: `docs/architecture.md` (padrões de abas, previews, estado/efeitos) e `docs/architecture/coding-standards.md`.
- App Bar: usar AppTopBar no estilo Transparent (botões flutuando sobre o Hero, com contraste adequado). Ao rolar, transição para estilo padrão.
- Tabs: usar componente DS genérico `Tabs` definido na 1.9 (labels configuráveis; role=Tab; indicador/foco visíveis).
- Títulos: usar `TitleBlock` (Large/Small) para título + descrição; slots `title`/`subtitle` devem adotar os estilos padrão via utilitários (`TitleText`, `TitleSubtitle`) ou `CompositionLocalProvider`. Tempo continua no Hero/AppBar.
- Instruções: renderizar passos numerados com `InstructionRow` (DS 1.9). Chips de tempo/temperatura e tooltips estão fora do escopo.
- Iconografia: consumir exclusivamente via `IconRegistry` (`ds/src/main/java/com/eliascoelho911/cookzy/ds/icons/IconRegistry.kt:1`).
- Strings: toda string de UI deve estar em `app/src/main/res/values/strings.xml` e ser consumida com `stringResource`.
- Ingredientes: manter política de `rawText` (Story 1.1); usar derivação on-demand para destacar quantidades quando possível (heurística simples: detectar números/frações + palavras comuns de unidade apenas para destaque visual, sem persistir unidade) e renderizar com `IngredientRow`.
- Previews: incluir pelo menos 1 por aba e por variação relevante (com/sem imagem; com tempo/sem tempo; nutrição vazia).

### Testing
- Compose UI: cobertura para troca de abas; destaque de quantidade derivada sem unidade; placeholders e estados de erro/carregamento.
- A11y: foco/indicador das abas; `contentDescription` no hero; leitura correta das quantidades; alvos ≥ 48dp.
- Strings/Ícones: verificar consumo via `stringResource` e `IconRegistry`.
- Execução: `./gradlew test connectedAndroidTest` (Compose UI Test disponível conforme `app/build.gradle.kts`).

## QA Results
Gate: PASS
Reviewer: Quinn (Test Architect)
Updated: 2025-11-03
Summary: Redesign foca em hierarquia e legibilidade; escopos fora do MVP corretamente adiados. Riscos baixos; Tabs genéricas definidas via DS 1.9.
Top Issues:
- low — CI/CD ausente para gate de regressões de UI (sugerido adicionar workflow mínimo).
- low — Destacar uso obrigatório de IconRegistry/strings.xml (reforçado em Dev Notes).
Evidence: PRD/Arquitetura referenciados; padrões de A11y/Previews presentes nas diretrizes; deps de Compose UI Test configuradas.
Gate File: docs/qa/gates/1.6-redesenhar-detalhe-da-receita.yml

## Change Log
| Date       | Version | Description                         | Author |
|------------|---------|-------------------------------------|--------|
| 2025-10-23 | 0.1     | Rascunho inicial (redesign Detalhe) | PM     |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
