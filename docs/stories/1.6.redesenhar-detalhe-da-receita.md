# Story 1.6: Redesenhar Detalhe da Receita (protótipo Compose)

## Status
Ready

## Story
**Como** usuário do Cookzy,
**eu quero** um Detalhe de Receita com hierarquia clara e abas consistentes,
**para** ler ingredientes/preparo/nutrição com melhor legibilidade.

## Acceptance Criteria
1. App Bar flutuante transparente sobre o Hero, com botões circulares ≥48dp e ícones exclusivos do `IconRegistry`. Permite apenas ações em escopo do Épico 01 (Voltar/Fechar e Editar). Ao rolar, ganha fundo sólido mantendo contraste AA.
2. Hero full-bleed com imagem da receita (fallback ilustrado) e tempo de preparo opcional usando `IconRegistry.Timer`. Não há overlay/botão de vídeo nem badge externa.
3. Bloco textual abaixo do Hero replica o layout: título “Large” e subtítulo curto vindos de `strings.xml`, com tempo de preparo alinhado ao título quando fornecido.
4. Tabs pill fixas: Ingredientes | Instruções | Nutrição (label pode ser “Preparo”). Devem ser acessíveis (role=Tab, indicador animado, foco visível) e sincronizadas com o conteúdo.
5. Ingredientes: cabeçalho com contagem (“6 itens”) seguido de lista usando `IngredientRow`, destacando quantidades derivadas do `rawText` (negrito) sem ações de carrinho ou compra.
6. Instruções: lista numerada simples via `InstructionRow`, permitindo ênfases no texto mas sem chips de temperatura/tempo, tooltips ou CTA de vídeo.
7. Acessibilidade: controles ≥48dp, `contentDescription` no Hero, leitura correta dos destaques, ordem de foco lógica e suporte a `fontScale≈2.0`.
8. Estados: loading skeleton para Hero/tabs/conteúdos, estado vazio (sem ingredientes/nutrição) e erro com ação de tentar novamente. Nenhum estado deve introduzir Stepper, Resumo, Prep Bar ou CTA de vídeo.

### UI Parity vs Mock (design/recipe-detail/img.png)
- Utilizar a referência apenas até a seção que está no escopo do Épico 01: App Bar flutuante (sem botões externos), hero com imagem + texto, tabs pill, lista de ingredientes e lista de instruções simples, além do placeholder de nutrição mostrado no mock.
- Itens exibidos no mock porém explicitamente fora do epic (Stepper de porções, Resumo Nutritivo, CTA “Iniciar Preparo”, botão “Medidas”, overlay/badge de vídeo, chips/tooltips e ações de carrinho) **não** devem aparecer na UI nem nos testes desta story.
- Responsividade: quando o mock exibir seções adicionais fora de escopo, manter apenas o espaçamento-base para que a tela continue consistente sem esses elementos.

## Dependencies
- PRD — Detalhe com abas e escopo: `docs/prd.md:72,111-130` (usar apenas instruções referentes a abas/estados; CTA de vídeo/macros seguem fora do Épico 01).
- Arquitetura (Compose): padrões de abas, A11y, Previews e Iconografia: `docs/architecture.md:60,80-86`;
  Coding Standards (IconRegistry, Previews, strings.xml): `docs/architecture/coding-standards.md:72-83,100-101`;
  Tech Stack (Material Icons Extended): `docs/architecture/tech-stack.md:12,48-49`.
- Layout de referência (mock): `design/recipe-detail/img.png` (captura anexada pelo time de design).
- DS — Componentes para RecipeDetail (pré‑requisito): `docs/stories/1.9.ds-componentes-recipe-detail.md`.

## Tasks / Subtasks
- [ ] App Bar + Hero — Implementar AppBar flutuante (Voltar/Editar) e Hero com tempo opcional, sem overlay de vídeo (AC: 1-3)
- [ ] Tabs pill — Integrar componente DS com labels “Ingredientes/Instruções/Nutrição” e acessibilidade (AC: 4)
- [ ] Ingredientes — Cabeçalho com contagem + lista `IngredientRow` com destaque de quantidades (AC: 5)
- [ ] Instruções — Lista numerada simples usando `InstructionRow` (AC: 6)
- [ ] Nutrição — Placeholder textual e lista simples quando houver dados (AC: 7)
- [ ] Estados/A11y — Skeletons, vazio, erro e verificação de contrastes/foco (AC: 8-9)

## Dev Notes
- Referência visual: layout `design/recipe-detail/img.png` (usar apenas as seções em escopo). Demais elementos são ignorados até que os épicos correspondentes sejam priorizados.
- Arquitetura/UI: `docs/architecture.md` (padrões de abas, estado/efeitos, scroll) e `docs/architecture/coding-standards.md` (IconRegistry, strings, previews).
- App Bar: usar variante `AppTopBar.Transparent` com `Modifier.statusBarsPadding()`. Clusters leading/trailing são `IconButton`s com fundo `CookzyColor.SurfaceInverse`. Em scroll > 56dp aplicar `AppTopBarDefaults.pinnedScrollBehavior()` e mudar cor.
- Hero: `RecipeHero` (story 1.9) deve suportar estados com e sem imagem, sem overlay de vídeo. Tempo de preparo opcional fica em linha com o título.
- Tabs: utilizar componente DS `Tabs` (pills). Labels em `strings.xml` (`recipe_detail_tab_ingredients`, etc.). Seleção controla `Pager`/`AnimatedContent`.
- Ingredientes: `IngredientRow` recebe `AnnotatedString` com `SpanStyle(fontWeight = Bold)` para números. Nenhum botão de carrinho/compra nesta story.
- Instruções: `InstructionRow` pode receber `AnnotatedString` para destacar menções, mas sem chips/tooltip. Qualquer referência especial deve ser texto puro.
- Nutrição: reutilizar `NutritionPlaceholder` (story 1.9) e fallback textual simples quando houver dados.
- Strings e ícones: toda cópia em `strings.xml`; ícones exclusivos do `IconRegistry`. Nenhum `Icons.Default`.
- Previews: criar variações para (1) hero com imagem; (2) sem imagem/tempo; (3) estados vazio/erro com `fontScale = 2f`.

### Testing
- Testes unitários para ViewModel (estados, efeitos, navegação).

## QA Results
Gate: TBD (escopo realinhado ao Épico 01 — aguardar nova revisão)
Reviewer: Quinn (Test Architect) — avaliação anterior cobrindo elementos fora do epic foi descartada
Updated: 2025-11-03
Summary: Após remover Stepper, CTA, Resumo e vídeo, a história volta a focar em App Bar + abas. QA precisa validar apenas os elementos em escopo (Hero, tabs, listas, estados).
Top Issues:
- medium — Falta caso de teste garantindo destaque de quantidade no `IngredientRow`.
- medium — Necessário validar leitura de estados vazio/erro com TalkBack.
Evidence: Epic `docs/epics/01-crud-de-receitas.md`, PRD seções 72/111-130 (abas) e atualizações desta story.
Gate File: docs/qa/gates/1.6-redesenhar-detalhe-da-receita.yml (reutilizar após nova revisão)

## Change Log
| Date       | Version | Description                         | Author |
|------------|---------|-------------------------------------|--------|
| 2025-11-03 | 0.3     | Escopo realinhado ao Épico 01 (tabs básicas, sem Stepper/CTA/vídeo) | PO     |
| 2025-11-03 | 0.2     | Escopo atualizado p/ layout completo (cards, CTA, stepper, chips) | PO     |
| 2025-10-23 | 0.1     | Rascunho inicial (redesign Detalhe) | PM     |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
