# Story 1.4: Redesenhar Home/Lista de Receitas (conforme wireframe)

## Status
Implemented

## Story
**Como** usuário do Cookzy,
**eu quero** uma Home/Lista com carrossel de recentes e alternância lista/grade com busca inline,
**para** descobrir rapidamente receitas e navegar com fluidez.

## Acceptance Criteria
1. Carrossel “Recentes” no topo: 1 card por viewport, com PEEK do próximo, snapping por cartão, sem indicador de página; tap abre Detalhe.
2. Cabeçalho da lista exibe “N receitas” e botões para alternar layout lista ↔ grade; preferência persiste localmente.
3. Busca inline na App Bar: ao ativar, campo substitui o título e filtra resultados localmente com debounce de 400 ms; limpar retorna ao título.
4. Estados: skeleton para carregamento; mensagem de erro com ação “Tentar de novo”; se Recentes vazio, exibir placeholder “Sem recentes” + CTA “Criar/Importar receita”.
5. Fora do escopo do Épico 01: carrossel de “Livros de Receitas” (filtro) — não deve aparecer no MVP deste épico.

## Tasks / Subtasks
- [x] UI — Carrossel “Recentes” com `HorizontalPager` (pageSize=Fill; contentPadding para PEEK; snap) (AC: 1, 4)
- [x] UI — Cabeçalho com contagem e alternância lista/grade (AC: 2)
- [x] UI — Lista/Grade com cards consistentes; navegação para Detalhe (AC: 2)
- [x] App Bar — Modo busca inline com debounce e limpar (AC: 3)
- [x] Estados — Skeletons/erro/empty coerentes (AC: 4)
- [x] A11y — Roles, labels e foco (AC: 1–4)
- [x] Persistência — Preferência lista↔grade via DataStore (ViewModel + UI) (AC: 2)
- [x] Testes — Compose UI para alternância, busca inline, navegação e estados (AC: 1–4)
- [x] Testes — Assegurar ausência do carrossel de “Livros de Receitas” no Épico 01 (AC: 5)

## Dev Notes
- Referência de design: design/wireframes/RecipeList-wireframe.md (anotado com itens fora do escopo do Épico 01).
- Arquitetura/UI: docs/ui-architecture.md (App Bar, padrões de lista/grade, prévias sugeridas).
- Dados para “Recentes”: ordenar por data de atualização/criação local; limitar a ~10 itens.
- Persistir preferência lista↔grade via DataStore.
- Não incluir carrossel de “Livros de Receitas” neste épico (Epic de Coleções tratará).

### Testing
- Compose UI: verificação de snapping 1 por viewport (com PEEK), alternância lista↔grade, debounce de busca (400 ms), placeholders de loading/erro, navegação para Detalhe.
- ViewModel: filtro local preservando contagem e alternância.
- Negativo: garantir que o carrossel de “Livros de Receitas” não é exibido no Épico 01.

## Change Log
| Date       | Version | Description                       | Author |
|------------|---------|-----------------------------------|--------|
| 2025-10-23 | 0.1     | Rascunho inicial (redesign Home)  | PM     |
| 2025-10-23 | 0.2     | ACs clarificados; pronto p/ Dev   | SM     |
| 2025-10-23 | 1.0     | Implementação UI/VM, prefs e testes | Dev    |

## Dev Agent Record

### Agent Model Used

OpenAI Codex CLI (James, dev)

### Debug Log References

- app/src/main/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListScreen.kt
- app/src/main/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListViewModel.kt
- app/src/main/java/com/eliascoelho911/cookzy/data/preferences/UserPreferencesRepositoryImpl.kt
- app/src/main/java/com/eliascoelho911/cookzy/di/AppModules.kt
- app/src/test/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListViewModelTest.kt
- app/src/androidTest/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListScreenTest.kt

### Completion Notes List

- Adicionada busca inline com debounce de 400 ms e limpar.
- Carrossel de recentes usando `HorizontalPager` (peek via `contentPadding`).
- Alternância lista/grade com persistência via DataStore (Koin DI).
- Estados de carregamento/erro/empty implementados.
- A11y básico: roles e contentDescription para abertura de receita.
- Testes: unit (ViewModel) e Compose UI mínimos.

### File List

- app/src/main/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListScreen.kt (modificado)
- app/src/main/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListViewModel.kt (modificado)
- app/src/main/java/com/eliascoelho911/cookzy/domain/model/RecipeListLayout.kt (novo)
- app/src/main/java/com/eliascoelho911/cookzy/domain/repository/UserPreferencesRepository.kt (novo)
- app/src/main/java/com/eliascoelho911/cookzy/data/preferences/UserPreferencesRepositoryImpl.kt (novo)
- app/src/main/java/com/eliascoelho911/cookzy/data/preferences/DataStores.kt (novo)
- app/src/main/java/com/eliascoelho911/cookzy/di/AppModules.kt (modificado)
- app/src/main/java/com/eliascoelho911/cookzy/feature/recipelist/PreviewData.kt (modificado)
- app/src/main/res/values/strings.xml (modificado)
- app/src/test/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListViewModelTest.kt (novo)
- app/src/androidTest/java/com/eliascoelho911/cookzy/feature/recipelist/RecipeListScreenTest.kt (novo)
- gradle/libs.versions.toml (modificado)
- app/build.gradle.kts (modificado)

## QA Results
